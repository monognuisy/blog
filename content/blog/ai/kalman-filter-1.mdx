---
title: Kalman Filter - 1 Dimensional
date: "2023-06-21"
description: "Localization ì˜ ëŒ€í‘œì  ë°©ë²•ì¸ Kalman filterì— ëŒ€í•´ ì•Œì•„ë³´ì."
tags: ["AI","Mathematics"]
categories: "AI"
---

## ë°°ê²½

ì¼ë‹¨, ì¹¼ë§Œ í•„í„°ê°€ ë¬´ì—‡ì¸ì§€ ì •í™•í•˜ê²Œ ì•Œì•„ë³´ê¸° ì „ì—, ì´ê²ƒì´ ì“°ì¸ ëŒ€í‘œì ì¸ ì‚¬ê±´ì„ ì•Œì•„ë³´ì.

ë°”ë¡œ ì•„í´ë¡œ ë¯¸ì…˜ì´ë‹¤.

ì•„ë¬´ê²ƒë„ ì—†ëŠ” ìš°ì£¼ ê³µê°„ì—ì„œ í˜„ì¬ ìì‹ ì˜ ìœ„ì¹˜ë¥¼ ì•„ëŠ” ê²ƒì€ êµ‰ì¥íˆ ì¤‘ìš”í•˜ë‹¤. ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëª©ì ì§€ê¹Œì§€ ë„ë‹¬í•˜ëŠ” ë°©ë²•ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì´ë‹¤. ì‹¬ì§€ì–´ ìš°ì£¼ì„ ì˜ ìœ„ì¹˜ëŠ” ê³„ì†í•˜ì—¬ ë°”ë€Œê³ , ì¸¡ì •ê¸°ì˜ ì„±ëŠ¥ì´ ì™„ë²½í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì´ëŠ” ë”ìš± ì–´ë ¤ì›Œì§„ë‹¤. ì™¸ë ¥ì´ ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ì˜ˆì¸¡í•˜ê¸° ì‰½ê² ë‹¤ê³  ìƒê°í•˜ëŠ” ì‚¬ëŒì´ ìˆì„ì§€ë„ ëª¨ë¥´ë‹ˆ, í•œ ê·¹ë‹¨ì ì¸ ì˜ˆì‹œë¥¼ ë“¤ì–´ë³´ì.

ì¸ë¥˜ ì—­ì‚¬ìƒ ê°€ì¥ ì„±ê³µì ì¸ ì‹¤íŒ¨ë¼ê³  ë¶ˆë¦¬ëŠ” â€˜ì•„í´ë¡œ 13 ë¯¸ì…˜â€™ì€ ë‹¬ íƒì‚¬ë¥¼ ê°€ë˜ ë„ì¤‘, ì‚°ì†Œ íƒ±í¬ê°€ í­íŒŒë˜ì–´ íƒì‚¬ë¥¼ í¬ê¸°í•˜ê³  ì§€êµ¬ë¡œ ë³µê·€í•œ ì‚¬ê±´ì´ë‹¤. ìš°ì£¼ì„ ì˜ ë™ë ¥ê³¼ ë‚´ë¶€ ì‚°ì†Œ ë“±ì´ ëª¨ë‘ ë¶€ì¡±í•œ ê·¹í•œ í™˜ê²½ì—ì„œ ëŒ€ì›ë“¤ì€ ê¸°ì ì ìœ¼ë¡œ ëª¨ë‘ ë¬´ì‚¬ ë³µê·€í•˜ì˜€ë‹¤.

ì´ ì•„í´ë¡œ 13 ë¯¸ì…˜ì—ì„œëŠ”, ì§€êµ¬ë¡œ ë³µê·€í•˜ëŠ” ê³¼ì •ì—ì„œ ê·¸ ì–´ëŠë•Œë³´ë‹¤ í˜„ì¬ ìì‹ ì˜ ìœ„ì¹˜ë¥¼ ì•Œì•„ë‚´ëŠ” ê¸°ë²•ì¸ localizationì´ ì¤‘ìš”í–ˆë‹¤. ë§Œì¼ ê·¸ ìœ„ì¹˜ë¥¼ ì¡°ê¸ˆì´ë¼ë„ ì–´ê¸‹ë‚˜ê²Œ ê³„ì‚°í•œë‹¤ë©´ ì¤‘ë ¥ê¶Œì„ ë²—ì–´ë‚˜ì„œ ì˜ì˜ ìš°ì£¼ë¯¸ì•„ê°€ ë˜ê±°ë‚˜ ì¤‘ë ¥ì˜ ì˜í–¥ì„ ë„ˆë¬´ ì„¸ê²Œ ë°›ì•„ì„œ ì§€ë©´ê³¼ í° ì¶©ëŒì´ ì¼ì–´ë‚˜ ì£½ê²Œ ë ì§€ë„ ëª¨ë¥´ëŠ” ìƒí™©ì´ì—ˆë‹¤.

ì‹¬ì§€ì–´ëŠ” ê·¸ ë‹¹ì‹œì— ì‚°ì†Œê°€ ìƒˆê³  ìˆì—ˆê¸° ë•Œë¬¸ì—, ìš°ì£¼ì„ ì€ ìˆ˜ì‹œë¡œ ëœë¤í•˜ê²Œ í”ë“¤ë ¸ê³  ì´ëŠ” ë”ìš± localizationì„ ê¹Œë‹¤ë¡­ê²Œ í–ˆë‹¤.

ë”ìš±ì´, ê·¸ ë‹¹ì‹œì˜ ì»´í“¨í„°ëŠ” ìš°ë¦¬ì˜ ìƒìƒë³´ë‹¤ í›¨ì”¬ ëŠë ¸ê³ , ì „ë ¥ë„ ì‹¬ê°í•˜ê²Œ ë¶€ì¡±í•˜ì—¬, ì •ë°€í•œ ê°’ì„ ì–»ê¸° ìœ„í•´ í° ë¹„ìš©ì˜ ê³„ì‚°ì„ ì‹œí‚¬ ìˆ˜ ì—†ëŠ” ìƒí™©ì´ì—ˆë‹¤.

ê·¸ë•Œ ì´ë“¤ì„ êµ¬ì›í•œ ê²ƒì€ ë°”ë¡œ ì¹¼ë§Œ í•„í„°(Kalman Filter)ì˜€ë‹¤. ì´ëŠ” ì§€ê¸ˆê¹Œì§€ì˜ ì¸¡ì •ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ í˜„ì¬ ìœ„ì¹˜ë¥¼ ì¶”ì •í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ, ë§ì´ ì¸¡ì •í•  ìˆ˜ë¡ ì¬ê·€ì ìœ¼ë¡œ ì •í™•ë„ê°€ ë†’ì•„ì§€ëŠ” ê²½í–¥ì´ ìˆëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ë˜í•œ, ê¸°ì¡´ì˜ ì•Œê³ ë¦¬ì¦˜ì— ë¹„í•´ ë§¤ìš° ë¹ ë¥´ê³  ê°’ì‹¸ê²Œ ìˆ˜í–‰ë  ìˆ˜ ìˆì–´ì„œ ë¹„ë‹¨ ì•„í´ë¡œ 13 ë¯¸ì…˜ ë¿ë§Œ ì•„ë‹Œ, ë‹¤ë¥¸ ì•„í´ë¡œ ë¯¸ì…˜ì—ì„œë„ ìœ ìš©í•˜ê²Œ ì“°ì˜€ë˜ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.

ê²°êµ­, ì¡°ê¸ˆ ê³¼ì¥í•˜ìë©´ ê·¸ ë‹¹ì‹œ ì¹¼ë§Œ í•„í„°ê°€ ì—†ì—ˆë‹¤ë©´ ì•„ë§ˆë„ ì•„í´ë¡œ 13 ë¯¸ì…˜ì€ ì¸ë¥˜ ì—­ì‚¬ì— ìˆì–´ì„œ êµ‰ì¥íˆ ë”ì°í•œ ì°¸ì‚¬ë¡œ ë‚¨ê²Œ ë˜ì—ˆì„ì§€ë„ ëª¨ë¥¸ë‹¤. ê·¸ë˜ì„œ, NASA ì¸¡ì—ì„œë„ ì¹¼ë§Œ í•„í„°ì˜ ìµœì´ˆì˜ í™œìš© ì‚¬ë¡€ë¡œ ì•„í´ë¡œ ë¯¸ì…˜ì„ ê¼½ê³  ìˆìœ¼ë©°, ì¹¼ë§Œ í•„í„°ì˜ ê³ ì•ˆì— íˆ¬ìë¥¼ í•œ íˆ¬ìì‚¬ë„ ì´ë¥¼ ëŒ€ëŒ€ì ìœ¼ë¡œ í™ë³´í•˜ê³  ìˆë‹¤.

## 1ì°¨ì› ì¹¼ë§Œ í•„í„°

localization ì˜ˆì‹œë¥¼ ê³„ì† ìƒê°í•´ë³´ì. $t$ ì‹œì ì— ì‹¤ì œ ë‚˜ì˜ ìœ„ì¹˜ë¥¼ $x_t$ ë¼ê³  í•˜ê³ , ì¸¡ì •ëœ ìœ„ì¹˜ë¥¼ $y_t$ ë¼ê³  í•˜ì.

ì´ë•Œ, ì‹¤ì œ ìœ„ì¹˜ì¸ $x_t$ëŠ” hidden[^hidden] ì´ë‹¤. ì¦‰, ìš°ë¦¬ëŠ” ì¸¡ì •ëœ ìœ„ì¹˜ $y_t$ë§Œ ì•Œ ìˆ˜ ìˆì„ ë¿ì´ë‹¤.

[^hidden]: latent variable ì´ë¼ê³ ë„ í•œë‹¤.

ì—¬ê¸°ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì¢…ì†ê´€ê³„ë¥¼ ê°€ì •í•˜ì.

$$
\begin{cases}
x_{t + 1} &= \alpha x_{t} + \beta + \varepsilon_{x} \\
y_{t} &= \lambda x_t + \varepsilon_y
\end{cases}
$$

ë‹¨, ì—¬ê¸°ì„œ $\alpha, \beta \in \R$ ì¸ ìƒìˆ˜ì´ê³ , $\varepsilon_x, \varepsilon_y$ ëŠ” ëª¨ë‘ í‰ê· ì´ $0$ ì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤. ë˜í•œ, $x_0$ ë„ ê°€ìš°ì‹œì•ˆì´ë¼ê³  ê°€ì •í•œë‹¤.

ë‹¹ì—°íˆ ë‹¤ìŒ ìœ„ì¹˜ëŠ” ì´ì „ ìœ„ì¹˜ì™€ ë°€ì ‘í•œ ê´€ê³„ê°€ ìˆê³ , ì¸¡ì •ê°’ì€ ì‹¤ì œ ìœ„ì¹˜ì™€ ë°€ì ‘í•œ ê´€ê³„ê°€ ìˆë‹¤ê³  ìƒê°í•˜ë©´ ì´ ê°€ì •ì€ ìì—°ìŠ¤ëŸ½ë‹¤.

ì´ëŸ¬ë©´, ë‹¤ìŒê³¼ ê°™ì€ graphical modelì„ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤.

$$
\begin{CD}
  x_0 @>>> x_1 @>>> \cdots @>>> x_t @>>> \cdots @>>> x_T \\
  @VVV  @VVV  @.  @VVV  @.  @VVV \\
  y_0 @>>> y_1 @>>> \cdots @>>> y_t @>>> \cdots @>>> y_T
\end{CD}
$$

ì¦‰, joint probability $p(x_0, \cdots, x_T, y_0 , \cdots, y_T)$ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
p(x_0)p(y_0 | x_0) p(x_1 | x_0)p(y_1 | x_1) \cdots p(x_{T} | x_{T-1}) p(y_T | x_T)
$$

ì—¬ê¸°ì„œ ìš°ë¦¬ì˜ ëª©ì ì€ ê¸°ì¡´ì˜ ì¸¡ì •ê°’ì¸ $y_0, \cdots, y_{T-1}$ ì™€ ìƒˆë¡œìš´ ì¸¡ì •ê°’ $y_T$ ë¥¼ ì´ìš©í•˜ì—¬ ì‹¤ì œê°’ì¸ $x_T$ë¥¼ ì¶”ì •í•˜ëŠ” ê²ƒì´ë‹¤. ì¦‰, ë‹¤ìŒì„ êµ¬í•˜ëŠ” ê²ƒì´ë‹¤.

$$
p(x_T | y_0, \cdots, y_T)
$$

ì´ë¥¼ ìœ„í•´ì„œëŠ” $x_0 , \cdots, x_{T-1}$  ì˜ ì´ $T$ ê°œì˜ ë³€ìˆ˜ë¥¼ marginalize í•˜ê³  $y_0, \cdots, y_T$ ë¥¼ conditioning í•´ì•¼ í•œë‹¤. ë¬´ì²™ì´ë‚˜ ë²ˆê±°ë¡œìš´ ì‘ì—…ì´ ì•„ë‹ ìˆ˜ ì—†ë‹¤. í•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‚¬ì‹¤ì„ ì•ˆë‹¤!

1. gaussianì„ marginalize í•´ë„ gaussian!
2. gaussianì„ conditioning í•´ë„ gaussian!

ì¦‰, ê²°ê³¼ë¬¼ì€ gaussianì´ë¯€ë¡œ ê·¸ê²ƒì˜ í‰ê· ê³¼ ë¶„ì‚°ë§Œ ì•Œë©´ ë˜ëŠ” ê²ƒì´ë‹¤.

### Option I - Closed form

ë˜í•œ, ë‹¤ìŒì„ ì•Œê³  ìˆìœ¼ë¯€ë¡œ

$$
\bm\mu_{1|2} = \bm\mu_1 + \Sigma_{12} \Sigma_{2}^{-1} ({\bf x}_2 - \bm\mu_2)
$$

$x_{T} | y_0, \cdots, y_T$ ì˜ í‰ê· ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\mu_{x_T | y_0, \cdots, y_T} = \mu_{x_T} + \Sigma_{x_T, y_0, \cdots, y_T} \Sigma _{y_0, \cdots, y_T}^{-1} ((y_0, \cdots, y_T)^\top  - \bm\mu_{y_0, \cdots, y_T})
$$

ì™€! ê·¼ë°â€¦

#### ğŸ¤” ë¬¸ì œì 

ë¬¼ë¡  closed formì´ê¸´ í•œë°â€¦ ì¡°ê¸ˆ ìƒê°í•´ë³´ë©´ ì´ ë¶€ë¶„ì´ ë§ˆìŒì— ê±¸ë¦°ë‹¤.

$$
\Sigma _{y_0, \cdots, y_T}^{-1}
$$

ì´ covariance matrixëŠ” $\R^{(T+1) \times (T+1)}$ ìœ¼ë¡œ, inverseëŠ” rankì˜ ì„¸ì œê³±ì— ë¹„ë¡€í•˜ëŠ” time complexityë¥¼ ê°€ì§€ê³  ìˆìœ¼ë¯€ë¡œ, ëŒ€ëµì ìœ¼ë¡œ ê³„ì‚°í•´ë„ ë‹¤ìŒê³¼ ê°™ì€ í•˜í•œì„ ê°€ì§„ë‹¤.

$$
\Omega((T+1)^3)
$$

ì„¸ì œê³±ì˜ orderë¥¼ ê°€ì§€ëŠ” ì•Œê³ ë¦¬ì¦˜ì€ í”íˆ â€˜**ì¢‹ì§€ ì•Šë‹¤ê³ **â€™ ì—¬ê²¨ì§„ë‹¤.

ì‹¬ì§€ì–´, 6~70ë…„ëŒ€ì˜ ì»´í“¨í„°ë¡œ ì´ì •ë„ì˜ ê³„ì‚°ì„ í•˜ë ¤ê³  í•˜ë©´ ì •ë§ ì˜¤ë˜ ê±¸ë¦´ ë¿ë”ëŸ¬, ì•„í´ë¡œ 13 ë¯¸ì…˜ ë‹¹ì‹œì˜ ê¸‰ë°•í•œ ìƒí™©ì—ì„œëŠ” ì„£ë¶ˆë¦¬ ì´ëŸ¬í•œ ê³„ì‚°ì„ í•  ì—„ë‘ê°€ ë‚˜ì§€ ì•Šì•˜ì„ ê²ƒì´ë‹¤.

ê²°êµ­ inverseê°€ ê°€ì¥ í° overheadì¸ë°, ì´ë¥¼ ìµœì†Œí™” í•˜ëŠ” ë°©ë²•ì´ ìˆì„ê¹Œ? ê·¸ë ‡ë‹¤. ì—†ì—ˆë‹¤ë©´, ì•„í´ë¡œ ë¯¸ì…˜ì´ ì¡´ì¬í•˜ì§€ ëª»í–ˆì„ ê²ƒì´ë‹¤.

### Option II - Recursive update

í•œêº¼ë²ˆì— closed formì„ êµ¬í•˜ë ¤ê³  í•˜ì§€ ë§ê³ , ì•ì„œ ê°€ì •í•œ ì¢…ì†ê´€ê³„ì— ë”°ë¼ ì´ë¥¼ ì¬ê·€ì ìœ¼ë¡œ updateí•´ë³´ì.

í˜„ì¬ ì‹œê° $T$ ëŒ€ì‹ , ì„ì˜ì˜ ì‹œê°„ $t$ë¥¼ ê°€ì •í•˜ì.

ì•ìœ¼ë¡œ, í˜¼ë™ì´ ì—†ì„ ë•Œì—ëŠ” í¸í•˜ê²Œ ë‹¤ìŒê³¼ ê°™ì€ í‘œê¸°ë¥¼ ì‚¬ìš©í•œë‹¤.

$$
{t+1 ~|~ t+1} := {x_{t+1} | y_0, \cdots, y_{t+1}}
$$

$$
t+1 , t+1 ~|~ t := x_{t+1}, y_{t+1} | y_{0} ,\cdots, y_t
$$

#### Observation update: $\mu _{t+1 | t+1}$

ë¨¼ì €, ìƒˆë¡œìš´ ì¸¡ì •ê°’ $y_{t + 1}$ë¥¼ ì´ìš©í•˜ì—¬ update í•˜ëŠ” ê³¼ì •ì„ ì•Œì•„ë³´ì.

conditional meanì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\mu_{t+1 | t+1} = \mu_{t+1 | t} + \sigma_{t+1, t+1 | t} ~\sigma^{-2}_{y_{t+1} | t} ~(y_{t+1} - \mathbb{E}[y_{t+1} | t])
$$

ì´ë¥¼ ì •ë¦¬í•˜ê¸°ì— ì•ì„œ, ì´ì „ì— overheadê°€ ë˜ì—ˆë˜ ë¶€ë¶„ì¸ $\sigma_{y_{t+1} | t}$  ë¶€ë¶„ì„ ì‚´í´ë³´ë©´, ì´ëŠ” 1-dimensionalì´ë‹¤. ë”°ë¼ì„œ, $O(1)$ ì— inverseê°€ ìˆ˜í–‰ë  ìˆ˜ ìˆë‹¤.

ì´ê²ƒì´ $t = 1 , \cdots, T$ ê¹Œì§€ ìˆ˜í–‰í•˜ë©´ ë˜ë¯€ë¡œ, $O(T)$ ì— $\mu_{T | T}$ ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤!

ì—„ì²­ë‚œ ë°œì „ì´ë‹¤. í•˜ì§€ë§Œ ì•„ì§ ë†€ë¼ê¸´ ì´ë¥´ë‹¤. ìœ„ ì‹ì„ ì¢€ ë” ì •ë¦¬í•˜ê¸° ìœ„í•´ì„œ $\sigma_{t+1, t+1 | t}$ ì™€ $\sigma_{y_{t+1} | t}$ ë¥¼ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\begin{align*}
\sigma^2_{y_{t+1} | t} &= \mathbb{E}[(\lambda x_{t+1} + \varepsilon_y)^2 | t] - \mathbb{E}[\lambda x_{t+1} + \varepsilon_y | t]^2 \\
&= \lambda ^2 \mathbb{E}[x_{t+1}^2 | t] + \lambda \mathbb{E}[x_{t+1}\varepsilon_y | t ] + \mathbb{E}[\varepsilon_y^2 | t] - \lambda^2 \mathbb{E}[x_{t+1} | t]^2
\end{align*}
$$

ì—¬ê¸°ì„œ $\varepsilon_y$ ëŠ” $y_0 ,\cdots, y_t$ ì— ëŒ€í•´ independent í•˜ë¯€ë¡œ $\mathbb{E}[\varepsilon _y | t] = \mathbb{E}[\varepsilon_y] = 0$ ì´ê³ ,

$x_{t+1}$ ê³¼ë„ independent í•˜ë¯€ë¡œ, $\mathbb{E}[x_{t+1} \varepsilon_y | t] = \mathbb{E}[x_{t+1} | t]\mathbb{E}[ \varepsilon_y | t] = 0$ ì´ë‹¤.

ë˜í•œ, $\mathbb{E}[x_{t+1} ^2 | t] - \mathbb{E}[x_{t+1} | t]^2 = \sigma_{t+1 | t}^2$ ì´ë¯€ë¡œ, ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\sigma_{y_{t+1} | t}^2 = \lambda^2 \sigma_{t+1 | t}^2 + \mathbb{E}[\varepsilon^2_y]
$$

$\sigma_{t+1, t+1 | t}$ ë˜í•œ ê³„ì‚°í•´ë³´ë©´

$$
\begin{align*}
\sigma_{t+1, t+1 | t} &= \mathbb{E}[x_{t+1}(\lambda x_{t+1} + \varepsilon_y) | t] - \mathbb{E}[x_{t+1} | t]~\mathbb{E}[\lambda x_{t+1} + \varepsilon_y | t] \\
&= \lambda \mathbb{E}[x_{t+1} ^2 | t ] - \lambda\mathbb{E}[x_{t+1} | t]^2 \\
&= \lambda \sigma_{t+1 | t}^2
\end{align*}
$$

ë”°ë¼ì„œ, meanì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\begin{align*}
\mu_{t+1 | t+1} &= \mu_{t+1 | t} + \frac{\lambda \sigma^2_{t+1 | t}}{\lambda^2 \sigma^2_{t+1 | t} + \mathbb{E}[\varepsilon^2_y ]} (y_{t+1} - \lambda \mu_{t+1 | t}) \\
&=\textcolor{crimson}{\frac{\mathbb{E}[\varepsilon_y^2]}{{\lambda^2 \sigma^2_{t+1 | t} + \mathbb{E}[\varepsilon^2_y ]}}} \mu_{t+1 | t} + \textcolor{cornflowerblue}{\frac{{\lambda^2 \sigma_{t+1 | t}^2 }}{{\lambda^2 \sigma^2_{t+1 | t} + \mathbb{E}[\varepsilon^2_y ]}} }\frac{y_{t+1}}{\lambda}

\end{align*}
$$

#### Observation update: $\sigma^2_{t+1 | t+1}$

ì´ì œëŠ” ë¶„ì‚°ì„ êµ¬í•´ë³´ì. conditional covarianceëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬í•  ìˆ˜ ìˆë‹¤.

$$
\sigma^2_{t+1 | t+1} = \sigma^2_{t+1 | t} - \sigma_{t+1, t+1 | t} \sigma^{-2}_{y_{t+1} | t} \sigma_{t+1, t+1 | t}
$$

ì—¬ê¸°ì„œ $\sigma_{t+1, t+1 | t} = \lambda \sigma_{t+1 | t}^2$ ì™€ $\sigma^{2}_{y_{t+1} | t} = \lambda^2 \sigma_{t+1 | t}^2 + \mathbb{E}[\varepsilon^2_y]$ ë¥¼ ëŒ€ì…í•˜ë©´ ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\begin{align*}
\sigma^{2}_{t+1 | t+1} &= \sigma^2_{t+1 | t} - \cfrac{\lambda^2 \sigma_{t+1 | t}^4}{\lambda^2 \sigma_{t+1 | t}^2 + \mathbb{E}[\varepsilon^2_y]} \\
&= \textcolor{crimson}{\cfrac{ \mathbb{E}[\varepsilon^2_y]}{\lambda^2 \sigma_{t+1 | t}^2 + \mathbb{E}[\varepsilon^2_y]}} ~ \textcolor{cornflowerblue}{\sigma_{t+1 | t}^2}
\end{align*}
$$

ì—¬ê¸°ì„œ ë¶‰ê²Œ í‘œì‹œëœ ë¶€ë¶„ì€ 1 ì´í•˜ì˜ ì–‘ìˆ˜ì´ê³ , íŒŒë—ê²Œ í‘œì‹œëœ ë¶€ë¶„ì€ ì´ì „ì˜ ë¶„ì‚°ì´ë‹¤.

ë”°ë¼ì„œ, ìƒˆë¡œìš´ ë°ì´í„° $y_{t+1}$ ë¥¼ ì´ìš©í•˜ì—¬ ì¶”ì •ì„ í•˜ë©´ ì´ì „ë³´ë‹¤ ë¶„ì‚°ì´ ì‘ì•„ì§„ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆê³ , ì´ëŠ” í™•ì‹ ë„ê°€ ì¦ê°€í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

ë§Œì¼ $\mathbb{E} [\varepsilon^2_y]$ ê°€ í¬ë©´ ê·¸ ê°ì†Œí­ì´ ì‘ì•„ì§„ë‹¤. vise versa.

#### Time update: $\mu_{t+1 | t}$

ê·¸ëŸ¼, ì‹œê°„ì´ íë¦„ì— ë”°ë¼ ì¶”ì •í•˜ëŠ” ê²½ìš°ë¥¼ ìƒê°í•´ë³´ì. ì¦‰, ì´ë²ˆì—ëŠ” ìƒˆë¡œìš´ ë°ì´í„° $y_{t+1}$ë¥¼ ì´ìš©í•˜ì—¬ ì¶”ì •í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ê¸°ì¡´ $t$ ì‹œì ì˜ ì¶”ì •ê°’ì„ ì´ìš©í•˜ì—¬ $t+1$ ì‹œì ì„ ì¶”ì •í•˜ëŠ” ê²ƒì´ë‹¤. ì¦‰, ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ìì—°ìŠ¤ëŸ½ê²Œ ë„ì¶œë˜ëŠ” ê²°ê³¼ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.

conditional meanì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\begin{align*}
\mu_{t+1 | t} &= \mathbb{E}[\alpha x_t + \beta + \varepsilon_x | t] \\
&= \alpha \mu_{t | t} + \beta
\end{align*}
$$

ì¦‰, ì´ì „ meanì„ updateí•œ ê²ƒì´ë‹¤. ì§ê´€ì ì´ë‹¤.

#### Time update: $\sigma^2_{t+1 | t}$

conditional covarianceëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\begin{align*}
\sigma^2_{t+1|t} &= \mathbb{E}[x_{t+1}^2 | t ] - \mathbb{E}[x_{t+1}|t]^2 \\
&= \mathbb{E}[(\alpha x_t + \beta + \varepsilon_x)^2 | t] - \mathbb{E}[\alpha x_t + \beta + \varepsilon_x | t]^2 \\
&= \alpha^2 \sigma^{2}_{t | t} + \mathbb{E}[\varepsilon_x^2]
\end{align*}
$$

ì´ëŠ” observation updateì™€ëŠ” ë‹¤ë¥´ê²Œ, varianceë¥¼ **ì¦ê°€**ì‹œí‚¤ëŠ” term $\mathbb{E}[\varepsilon^2_x]$ì´ ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ì§ê´€ì ìœ¼ë¡œ ìƒê°í•˜ë©´, ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì´ì „ ì¶”ì •ê°’ì— ëŒ€í•œ ì‹ ë¢°ë„ê°€ ë‚®ì•„ì§„ë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤.

### ê·¸ë˜ì„œ?

ê²°êµ­ ì´ time updateì™€ observation updateë¥¼ ë°˜ë³µí•˜ë©´ ì„ì˜ì˜ ì‹œì ì—ì„œì˜ ìœ„ì¹˜ë¥¼ ì¶”ì •í•  ìˆ˜ ìˆê³ , ê·¸ ì •í™•ë„ëŠ” ì ì  ë†’ì•„ì§„ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë˜í•œ, ê° updateëŠ” $O(1)$ ì´ë¯€ë¡œ, ì•„ì£¼ ì‰½ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤!

ì´ë ‡ê²Œ ì•„í´ë¡œ ë¯¸ì…˜ì€ ì„±ê³µí•  ìˆ˜ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ, ì‚¬ì‹¤ ìœ„ì¹˜ë¥¼ ì•„ëŠ” ê²ƒ ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•˜ë‹¤. ì •í™•íˆëŠ” í˜„ì¬ ìœ„ì¹˜ì™€ ì†ë„ë¥¼ ì•Œì•„ì•¼ ë¯¸ë˜ì˜ ìš´ë™ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ, í˜„ì‹¤ì ìœ¼ë¡œëŠ” ìœ„ì¹˜ì™€ ì†ë„ë¥¼ ë¬¶ì–´ì„œ í•˜ë‚˜ì˜ ë²¡í„°(í˜¹ì€ í–‰ë ¬)ë¡œ ìƒê°í•˜ì—¬ kalman filterë¥¼ ì ìš©í•œë‹¤.

ì´ì— ëŒ€í•´ì„œëŠ” ë‹¤ìŒì— ì•Œì•„ë³´ì!
